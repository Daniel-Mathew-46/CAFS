CREATE TABLE admin (
  id INT PRIMARY KEY AUTO_INCREMENT,
  username VARCHAR(255) NOT NULL UNIQUE,
  email VARCHAR(255) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL
);

CREATE TABLE hr (
  id INT PRIMARY KEY AUTO_INCREMENT,
  admin_id INT NOT NULL,
  username VARCHAR(255) NOT NULL UNIQUE,
  fullname VARCHAR(255) NOT NULL,
  organization VARCHAR(255) NOT NULL,
  phone VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  FOREIGN KEY (admin_id) REFERENCES admin(id)
);

CREATE TABLE job (
  id INT PRIMARY KEY AUTO_INCREMENT,
  job_title VARCHAR(255) NOT NULL,
  requirements TEXT NOT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  hr_id INT NOT NULL,
  FOREIGN KEY (hr_id) REFERENCES hr(id)
);

CREATE TABLE cv (
  id INT PRIMARY KEY AUTO_INCREMENT,
  phone VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL,
  fullname VARCHAR(255) NOT NULL
);

CREATE TABLE education (
  id INT PRIMARY KEY AUTO_INCREMENT,
  cv_id INT NOT NULL,
  degree VARCHAR(255) NOT NULL,
  institution VARCHAR(255) NOT NULL,
  graduation_year INT NOT NULL,
  FOREIGN KEY (cv_id) REFERENCES cv(id)
);

CREATE TABLE experience (
  id INT PRIMARY KEY AUTO_INCREMENT,
  cv_id INT NOT NULL,
  company VARCHAR(255) NOT NULL,
  position VARCHAR(255) NOT NULL,
  start_year INT NOT NULL,
  end_year INT NOT NULL,
  FOREIGN KEY (cv_id) REFERENCES cv(id)
);

CREATE TABLE skill (
  id INT PRIMARY KEY AUTO_INCREMENT,
  cv_id INT NOT NULL,
  name VARCHAR(255) NOT NULL,
  level INT NOT NULL,
  FOREIGN KEY (cv_id) REFERENCES cv(id)
);

CREATE TABLE job_cv_upload (
  id INT PRIMARY KEY AUTO_INCREMENT,
  cv_id INT NOT NULL,
  job_id INT NOT NULL,
  cv_file BLOB NOT NULL,
  FOREIGN KEY (cv_id) REFERENCES cv(id),
  FOREIGN KEY (job_id) REFERENCES job(id)
);

CREATE TABLE analysis (
  id INT PRIMARY KEY AUTO_INCREMENT,
  job_id INT NOT NULL,
  cv_id INT NOT NULL,
  score FLOAT NOT NULL,
  FOREIGN KEY (job_id) REFERENCES job(id),
  FOREIGN KEY (cv_id) REFERENCES cv(id)
);
